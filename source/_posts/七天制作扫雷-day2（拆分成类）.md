---
title: 七天制作扫雷-day2（拆分成类）
url: 七天扫雷day2
date: 2024-06-04 10:51:05
categories:
- 七天扫雷
tags:
- 前端
- 小玩具
---

与文档配套的源码和资源在[这里](https://github.com/vitsumoc/7daysMineSweeper)

<!-- more -->

#  面向对象

![](1.jpg)

面向对象的方法并不会像之前那样，直接关注过程和实现，而是先拆分问题，将一个综合性的问题拆分为很多相关的 `类(class)`，用来表示某种类型的汇总，这些类又可以有具体的存在被称为 `实例(instance)`，每一个类都会具有一些 `属性(member)` 和 `方法(method)`，属性表示类或者实例的特性，方法则表示类或者实例可以进行的行为。

好的，相信你已经被绕晕了，以上四个概念就是面向对象中最基础的概念，接下来我们用一个例子来表示：

- *我要办一所小学，目的是培养小学生*，这句话只关注了目标，没有拆分问题，这**不叫面向对象**。

- *小学需要校长、教师、保安、清洁工、厨师*，这句话将综合性的问题拆分成了支持这个问题的 `类`，对于办小学这个问题而言，需要五种不同的 `类`。

- *招聘到三名教师，王老师、许老师和邓老师*，教师是一种 `类`，而 王老师、许老师和邓老师都是 `教师类` 的 `实例`。

- *王老师和许老师是男性，邓老师是女性*，性别是 `教师类` 的一种 `属性`，王老师的 `性别属性值` 为男性，邓老师的 `性别属性值` 为女性。

- *王老师是语文老师，许老师和邓老师是数学老师*，学科是 `教师类` 的另一种 `属性`，王老师的 `学科属性值` 为语文，许老师的 `学科属性值` 为数学，`教师类` 可以拥有多种属性，只要和主要问题相关的属性都需要被纳入考虑。

- *三名老师都可以上课*，上课是 `教师类` 的一种 `方法`，表示某种类可以执行的行为和带来的后果。上课带来了占用课时、为教师计薪、提高学生成绩等等后果。

好了，面向对象就是这样，这种方式让我们把话说的复杂又精确，最重要的是，相比于 *办小学* 这个模糊的目标，面向对象的思维方式为我们提供了一条清晰的解决路径。所谓编程，就是一个将含糊的目标逐渐明确，最终明确到计算机也能够执行的过程，面向对现的思维方式在这个过程中总是能帮助我们很多。

# 扫雷中的面向对象

那么将扫雷游戏简单拆分一下，可以这样分：

- 交互逻辑 （输入事件捕获及处理）
- 游戏逻辑 （游戏计算）
- 显示逻辑 （游戏界面输出）

我打算设计这些 `类` 来分工上述的三种逻辑：

| 类 | 功能 | 负责逻辑 |
| --- | --- | --- |
| 游戏控制类 | 游戏初始化入口<br />持有棋盘类和格子类实例<br />输入事件的捕捉、判断、转发<br />预留控制接口（外部菜单、网络接口等等） | 是交互的统一入口<br />不负责游戏逻辑<br />不负责显示逻辑 |
| 棋盘类 | 扫雷游戏的盘面信息<br />包括行数、列数、雷数、打开格子数 | 不负责交互逻辑<br />负责游戏逻辑中的棋盘<br />不负责显示逻辑 |
| 格子类 | 扫雷游戏的格子<br />包括格子的位置、是否有雷、是否已经打开 | 负责交互逻辑中的处理<br />负责游戏逻辑中的格子<br />不负责显示逻辑 |
| 显示类 | 通过盘面信息，绘制游戏界面<br />HTML页面可通过dom元素、SVG、Canvas等方式绘制<br />本教程中会提供dom和svg两种方式的代码实现 | 只负责显示逻辑 |

拆分后的项目文件夹如下表：

| 文件 | 作用 |
| --- | --- |
| asset文件夹 | 存放游戏中可能使用的图形资源 |
| app.css | 全局样式表 |
| app.html | 游戏入口 |
| board.js | 棋盘类 |
| cell.js | 格子类 |
| game.js | 游戏控制类 |
| view_canvas.js | canvas方式的显示类 |
| view_dom.js | dom方式的显示类 |
| view_svg.js | svg方式的显示类 |

到此处为止，我们没有进行任何代码编写，只是将游戏拆分成了各种类。相比于上一章的实现，似乎我们把一件简单的事情变复杂了，但实际上这种设计会在软件需求变复杂时大大降低我们的心智负担。